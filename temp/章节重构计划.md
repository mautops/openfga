# 章节重构计划

## 📋 重构目标

### 核心问题
1. **代码过多** - 章节中包含大量完整代码，影响阅读体验
2. **标题过碎** - 标题层级过多，导致内容零碎
3. **AI 味重** - 需要更自然的写作风格
4. **缺少引用** - 完整代码应该链接到示例，而非直接展示

### 改进方向
1. **文字为主** - 用文字描述概念、原理、使用场景
2. **代码精简** - 只保留关键代码片段，用于说明核心概念
3. **添加引用** - 完整代码链接到 models/ 或 integrates/ 目录
4. **优化结构** - 合并相关小节，减少标题层级
5. **自然表达** - 去除 AI 写作痕迹，更贴近真实作者风格

## 📝 重构原则

### 1. 代码使用原则
- ✅ **保留**：关键概念的简短示例（5-15 行）
- ✅ **保留**：配置文件片段（展示核心配置）
- ✅ **保留**：命令行操作（必要的操作步骤）
- ❌ **删除**：完整的类定义（链接到示例）
- ❌ **删除**：完整的 API 实现（链接到示例）
- ❌ **删除**：重复的代码示例

### 2. 内容组织原则
- 每个大节（3.1, 3.2）包含 2-4 个小节
- 避免过深的标题层级（最多到 ####）
- 相关内容合并，避免碎片化
- 每节 800-1500 字为宜

### 3. 写作风格原则
- 用第一人称或第二人称，更亲切
- 避免"让我们"、"首先"、"其次"等 AI 常用词
- 加入个人经验、踩坑经历
- 用比喻、类比让概念更易懂

## 📊 章节重构顺序

### 第一批（基础章节）
1. ✅ 第3章 - 快速入门
2. 第4章 - OpenFGA架构与组件
3. 第8章 - SDK集成实战

### 第二批（核心章节）
4. 第5章 - 授权模型设计
5. 第6章 - 关系元组管理
6. 第7章 - HTTP和gRPC API使用

### 第三批（高级章节）
7. 第9章 - 高级授权模式
8. 第10章 - 性能优化与扩展
9. 第11章 - 部署与运维

### 第四批（实践章节）
10. 第12章 - 企业级应用实践案例
11. 第13章 - 系统集成实践
12. 第15章 - AI场景权限管理基础与框架集成
13. 第16章 - AI应用实践案例与最佳实践

### 第五批（总结章节）
14. 第14章 - 授权系统对比与迁移策略
15. 第17章 - 总结与展望

## 🔧 重构模板

### 章节结构模板

```markdown
# 第 X 章：章节标题

简短的章节引言（1-2 段，200-300 字）
- 说明本章要解决什么问题
- 为什么这个问题重要
- 读者能学到什么

## X.1 大节标题

### 核心概念介绍
用 2-3 段文字介绍核心概念（400-600 字）
- 是什么
- 为什么需要
- 如何工作

### 实践操作
简短的代码示例（5-15 行）
```code
关键代码片段
```

**完整示例**：参考 [示例名称](../models/xx.xx.xxx/) 或 [集成示例](../integrates/xx.xxx/)

### 注意事项
- 常见问题
- 最佳实践
- 避坑指南

## X.2 大节标题

（类似结构）

## 本章小结

- 总结核心要点（3-5 条）
- 下一章预告
```

### 代码引用模板

```markdown
OpenFGA 的授权模型使用 DSL 语法定义。以文档权限为例：

```fga
type document
  relations
    define owner: [user]
    define viewer: [user] or owner
```

这个模型定义了文档的两种关系：owner（所有者）和 viewer（查看者）。viewer 权限会自动继承 owner 权限。

**完整模型定义**：参考 [文档基础权限模型](../models/05.01.document-basic/)

**实际应用示例**：参考 [FastAPI 集成示例](../integrates/03.fastapi-integration/)
```

## 📈 进度跟踪

| 章节 | 状态 | 预计字数 | 实际字数 | 完成时间 |
|------|------|---------|---------|---------|
| 第3章 | 进行中 | 3000-4000 | - | - |
| 第4章 | 待开始 | 4000-5000 | - | - |
| 第5章 | 待开始 | 5000-6000 | - | - |
| 第6章 | 待开始 | 4000-5000 | - | - |
| 第7章 | 待开始 | 4000-5000 | - | - |
| 第8章 | 待开始 | 5000-6000 | - | - |
| 第9章 | 待开始 | 5000-6000 | - | - |
| 第10章 | 待开始 | 4000-5000 | - | - |
| 第11章 | 待开始 | 5000-6000 | - | - |
| 第12章 | 待开始 | 4000-5000 | - | - |
| 第13章 | 待开始 | 5000-6000 | - | - |
| 第14章 | 待开始 | 3000-4000 | - | - |
| 第15章 | 待开始 | 4000-5000 | - | - |
| 第16章 | 待开始 | 4000-5000 | - | - |
| 第17章 | 待开始 | 3000-4000 | - | - |

## 🎯 质量标准

### 内容质量
- [ ] 文字为主，代码为辅
- [ ] 代码片段精简（每个 5-15 行）
- [ ] 完整代码有引用链接
- [ ] 标题层级合理（最多 4 级）
- [ ] 每节内容连贯，不碎片化

### 写作风格
- [ ] 去除 AI 味（避免"让我们"、"首先"等）
- [ ] 语言自然，有个人风格
- [ ] 有实际经验和踩坑故事
- [ ] 用比喻和类比解释概念

### 技术准确性
- [ ] 概念解释准确
- [ ] 代码示例可运行
- [ ] 引用链接正确
- [ ] 最佳实践合理

## 📚 参考资源

### 示例目录
- `models/` - 48 个授权模型示例
- `integrates/` - 9 个集成示例

### 写作参考
- 《代码整洁之道》- 代码示例的使用
- 《技术写作指南》- 技术文档的组织
- 优秀技术书籍 - 学习写作风格
